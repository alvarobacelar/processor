from kafka import KafkaProducer
from json import dumps

timestamp = "2001-09-01 20:00:00"

value_message = "{\"timestamp\":{\"$date\":1637254800000},\"read\":{\"RD1_MD_VRM01_PID_MILL_FEED\":13642,\"RD1_PV_BI05_WEIGHT\":12536,\"RD1_MD_DA02_PID_RECIRCULATING\":10324,\"RD1_SP_RB1_TOTAL_FEED\":21478,\"RD1_MD_BI01_PID_LEVEL_LIMESTONE_CLAY\":1623,\"RD1_PV_BI01_PID_AUTO_LEVEL_LIMESTONE_CLAY\":6915,\"RD1_SP_BI01_PID_MANUAL_LEVEL_LIMESTONE_CLAY\":8072,\"RD1_PV_BI01_LEVEL_LIMESTONE_CLAY\":17929,\"RD1_PV_BI02_LEVEL_HG_LIMESTONE\":841,\"RD1_PV_BI03_LEVEL_CORRECTIVE\":4715,\"RD1_PV_BI04_LEVEL_IRON_ORE\":17615,\"RD1_SP_DA01_MILL_FAN\":11798,\"RD1_PV_DA01_MILL_FAN_POSITION\":16224,\"RD1_SP_DA02_PID_MANUAL_RECIRCULATING\":18133,\"RD1_PV_DA02_PROCESS_POSITION\":22885,\"RD1_SP_DA03_PID_MANUAL_HOT_GAS\":6862,\"RD1_PV_DA03_PROCESS_POSITION\":32629,\"RD1_SP_DA04_PID_MANUAL_BYPASS_HOT_GAS\":14878,\"RD1_PV_DA04_PROCESS_POSITION\":6923,\"RD1_SP_DA05_FRESH_AIR\":27085,\"RD1_SP_DA05_PROCESS_POSITION\":29400,\"RD1_SP_VRM01_PID_MANUAL_MILL_FEED\":16321,\"RD1_PV_WF02_HG_LIMESTONE_WEIGHT\":4591,\"RD1_PV_WF03_CORRECTIVE_WEIGHT\":656,\"RD1_PV_WF01_LIME_CLAY_WEIGHT\":7058,\"RD1_PV_BC01_CURRENT\":17668,\"RD1_PV_BC02_CURRENT\":10677,\"RD1_PV_BC03_CURRENT\":119,\"RD1_PV_BC05_CURRENT\":23041,\"RD1_PV_BE03_CURRENT\":8891,\"RD1_PV_BL02_CURRENT\":14957,\"RD1_PV_DG04_CURRENT\":14193,\"RD1_PV_FN01_CURRENT\":10891,\"RD1_PV_RF01_CURRENT\":26814,\"RD1_PV_RF02_CURRENT\":13787,\"RD1_PV_RF03_CURRENT\":7239,\"RD1_PV_RF04_CURRENT\":28074,\"RD1_PV_RF05_CURRENT\":25020,\"RD1_PV_RF06_CURRENT\":10827,\"RD1_PV_VRM01_CURRENT_MOTOR\":20686,\"RD1_PV_VRM01_CURRENT_FORCED_VENTILATION\":26385,\"RD1_SP_CLA01_SPEED\":5093,\"RD1_PV_CLA01_TEMPERATURE_MANCAL_SUP_INT\":27759,\"RD1_PV_CLA01_TEMPERATURE_MANCAL_SUP_EXT\":700,\"RD1_PV_CLA01_TEMPERATURE_MANCAL_INF\":13452,\"RD1_SP_DA03_PID_AUTO_HOT_GAS\":12170,\"RD1_SP_DA04_PID_AUTO_BYPASS_HOT_GAS\":11909,\"RD1_PV_FN01_TEMPERATURE_BEARING_DE\":23105,\"RD1_PV_FN01_TEMPERATURE_BEARING_NDE\":9412,\"RD1_PV_FN01_WINDING_TEMPERATURE_L1_1\":15765,\"RD1_PV_FN01_WINDING_TEMPERATURE_L1_2\":5767,\"RD1_PV_FN01_WINDING_TEMPERATURE_L2_1\":15407,\"RD1_PV_FN01_WINDING_TEMPERATURE_L2_2\":10677,\"RD1_PV_FN01_WINDING_TEMPERATURE_L3_1\":13784,\"RD1_PV_FN01_WINDING_TEMPERATURE_L3_2\":704,\"RD1_PV_FN01_MOTOR_BEARING_DE\":14790,\"RD1_PV_FN01_MOTOR_BEARING_NDE\":9834,\"RD1_PV_LE01_TEMPERATURE_ROLLING_BEARING_1\":12600,\"RD1_PV_LE01_TEMPERATURE_ROLLING_BEARING_2\":10819,\"RD1_PV_LE01_TEMPERATURE_THRUST_PAD_BEAR_1\":14318,\"RD1_PV_LE01_TEMPERATURE_THRUST_PAD_BEAR_2\":2290,\"RD1_PV_LE01_TEMPERATURE_LP_OIL\":14984,\"RD1_PV_LE01_TEMPERATURE_LUBRIFICATION_LINE\":16339,\"RD1_PV_VRM01_TEMPERATURE_INLET\":1988,\"RD1_PV_VRM01_TEMPERATURE_OUTLET\":7441,\"RD1_PV_VRM01_WINDING_TEMPERATURE_L1_1\":30104,\"RD1_PV_VRM01_WINDING_TEMPERATURE_L1_2\":13946,\"RD1_PV_VRM01_WINDING_TEMPERATURE_L2_1\":7056,\"RD1_PV_VRM01_WINDING_TEMPERATURE_L2_2\":18509,\"RD1_PV_VRM01_WINDING_TEMPERATURE_L3_1\":29833,\"RD1_PV_VRM01_WINDING_TEMPERATURE_L3_2\":17708,\"RD1_PV_VRM01_MOTOR_BEARING_DE\":19761,\"RD1_PV_VRM01_MOTOR_BEARING_NDE\":6533,\"RD1_PV_HYS01_ROLLER_PRESSURE\":1798,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_1\":22086,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_2\":32018,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_3\":15621,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_4\":30424,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_5\":22597,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_6\":21376,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_7\":24254,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_8\":29669,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_9\":18108,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_10\":12927,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_11\":12493,\"RD1_PV_LE01_PRESSURE_THRUST_PAD_BEAR_12\":26068,\"RD1_PV_LE01_PRESSURE_HP_INLET\":6366,\"RD1_PV_LE01_PRESSURE_LUBRIFICATION_OIL\":9102,\"RD1_PV_LE01_PRESSURE_RADIAL_SLIDE_BEARING_OIL\":2438,\"RD1_PV_BC03_POWER\":29857,\"RD1_PV_BE03_POWER\":25264,\"RD1_PV_CLA01_CLASSIFIER_POWER\":24241,\"RD1_PV_FN01_POWER\":621,\"RD1_PV_VRM01_POWER\":14804,\"RD1_SP_WI01_INJECTION_WATER\":16251,\"RD1_PV_WI01_FLOW_WATER_SPRAY\":13370,\"RD1_PV_LE01_FLOW_THRUST_PAD_BEARING\":2556,\"RD1_PV_LE01_FLOW_RADIAL_SLIDE_BEARING\":25808,\"RD1_PV_DG01_POSITION\":23024,\"RD1_PV_CY01_PRESSURE_OUTLET\":5227,\"RD1_SP_DA02_PID_AUTO_RECIRCULATING\":12274,\"RD1_CA_VRM01_DIFFERENCE_PRESSURE\":16798,\"RD1_SP_VRM01_PID_AUTO_MILL_FEED\":19002,\"RD1_PV_VRM01_PRESSURE_INLET\":10142,\"RD1_PV_VRM01_PRESSURE_OUTLET\":18842,\"RD1_PV_VRM01_POSITION_ROLLER_1\":1726,\"RD1_PV_VRM01_POSITION_ROLLER_2\":2226,\"RD1_PV_VRM01_POSITION_ROLLER_3\":31620,\"RD1_PV_VRM01_POSITION_ROLLER_4\":4343,\"RD1_SP_VRM01_ROLLER_PRESSURE\":2554,\"RD1_MD_VRM01_ON_OFF\": null,\"RD1_PV_CLA01_SPEED_ACTUAL\":11829,\"RD1_PV_AWF01_FEED_RATE_LIME_CLAY\":821,\"RD1_PV_AWF01_FEEDER\":24643,\"RD1_PV_RB1_TOTAL_FEED\":4632,\"RD1_PV_WF02_FEEDER\":5934,\"RD1_PV_WF02_FLOW_RATE_HG_LIMESTONE\":13063,\"RD1_PV_WF03_FEEDER\":29761,\"RD1_PV_WF03_FLOW_RATE_CORRECTIVE\":20415,\"RD1_PV_WF04_FEEDER\":11959,\"RD1_PV_WF04_FLOW_RATE_IRON_ORE\":25012,\"RD1_PV_FN01_VIBRATION_MOTOR_DE\":18085,\"RD1_PV_FN01_VIBRATION_MOTOR_NDE\":27734,\"RD1_PV_FN01_VIBRATION_FAN_DE\":25190,\"RD1_PV_FN01_VIBRATION_FAN_NDE\":20542,\"RD1_PV_VRM01_VIBRATION_MOTOR_DE\":9578,\"RD1_PV_VRM01_VIBRATION_MOTOR_NDE\":1187,\"RD1_PV_VRM01_VIBRATION\":113,\"RD1_MD_DA03_PID_HOT_GAS\":15038,\"RD1_MD_DA04_PID_BYPASS_HOT_GAS\":5084,\"PD1_BF_INLET_PRESS\":30259,\"RD1_PV_WF01_IRON_ORE_WEIGHT\":28411,\"RD1_PV_WI01_WATER_TONRATIO\":26124,\"RD1_PV_CLA01_SPEED\":12448,\"RD1_SP_WI01_WATER_TONRATIO\":18738,\"RD1_PV_FINENESS_170\":30412,\"RD1_PV_VRM01_ENERGY_DEMAND\":8007,\"RD1_RD1_H2O_LIME_CLAY\":17584,\"RD1_RD1_H2O_CLAY_AT\":10951,\"RD1_RD1_H2O_CLAY_DECAP\":23101,\"RD1_RD1_H2O_CLAY_MT\":14489,\"RD1_RD1_H2O_LIMESTONE\":24958,\"RD1_RD1_H2O_SLAG\":15441,\"RD1_RD1_H2O_ORE\":1790,\"RD1_RD1_H2O_PROD_MIX\":17013,\"RD1_PV_AWF01_PROD\":21060,\"RD1_PV_AWF01_MOISTURE\":14855,\"RD1_PV_AWF02_PROD\":8472,\"RD1_PV_AWF02_MOISTURE\":7093,\"RD1_PV_AWF03_PROD\":32676,\"RD1_PV_AWF03_MOISTURE\":25402,\"RD1_PV_AWF04_PROD\":7373,\"RD1_PV_AWF04_MOISTURE\":13543},\"predicted\":{}}"

producer = KafkaProducer(bootstrap_servers=['127.0.0.1:9092'], value_serializer=lambda x: dumps(x).encode("utf-8"), key_serializer=lambda x: dumps(x).encode("utf-8"))

for x in range(1):
    result = producer.send("tags_values", value=value_message, key=timestamp)
    producer.flush()

print (result.value)